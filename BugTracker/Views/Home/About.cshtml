
<div class="container">

    <input type="text" id="message" />
    <input type="button" id="sendmessage" value="Send" />
    <input type="hidden" id="displayname" />
    <ul id="discussion">

    </ul>

</div>
@*<div id="fun-chat-body"/>

<form id="fun-chat-form">
    <input id="fun-chat-input" type="text" style="position: absolute;"/>
</form>*@

@section scripts{

    
    <script src="~/Scripts/jquery.signalR-2.4.1.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            // reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (username, message) {
                // add the message to the page.
                $('#discussion').append('<li><strong>' + htmlencode(username)
                    + '</strong>: ' + htmlencode(message) + '</li>');
            };
            // get the user name and store it to prepend to messages.
            //$('#displayname').val(prompt('enter your name:', ''));
            // set initial focus to message input box.
            $('#message').focus();
            // start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // call the send method on the hub.
                    chat.server.send($('#message').val());
                    // clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
            });
        });
         //this optional function html-encodes messages for display in the page.
        function htmlencode(value) {
            var encodedvalue = $('<div />').text(value).html();
            return encodedvalue;
        }


        //$(function () {
        //    // reference the auto-generated proxy for the hub.
        //    var chat = $.connection.chathub;
        //    // create a function that the hub can call back to display messages.
        //    chat.client.addnewmessagetopage = function (name, message) {
        //        // add the message to the page.
        //        $('#discussion').append('<li><strong>' + htmlencode(name)
        //            + '</strong>: ' + htmlencode(message) + '</li>');
        //    };
        //    // get the user name and store it to prepend to messages.
        //    $('#displayname').val(prompt('enter your name:', ''));
        //    // set initial focus to message input box.
        //    $('#message').focus();
        //    // start the connection.
        //    $.connection.hub.start().done(function () {
        //        $('#sendmessage').click(function () {
        //            // call the send method on the hub.
        //            chat.server.send($('#displayname').val(), $('#message').val());
        //            // clear text box and reset focus for next comment.
        //            $('#message').val('').focus();
        //        });
        //    });
        //});
        // //this optional function html-encodes messages for display in the page.
        //function htmlencode(value) {
        //    var encodedvalue = $('<div />').text(value).html();
        //    return encodedvalue;
        //}

        @*var chatHub = $.connection.chatHub;
        var funChat = $('#fun-chat-body');
        var funChatForm = $('#fun-chat-form');
        var funChatInput = $('#fun-chat-input');
        var chatroom = '@ViewBag.Chatroom';

        funChat.click(function (event){
            funChatInput.show()
                .offset({ left: event.clientX, top: event.clientY }).focus()
        })

        funChatForm.submit(function () {
            var message = funChatInput.val();
            var position = funChatInput.offset();
            chatHub.server.sendMessage(chatroom, message, position.left,
                position.top
            );
            funChatInput.val('').hide();
            return false;
        })

        chatHub.client.onNewPrivateMessage = function (username, message, left, top) {
            var newMessage = $('<a>')
                .addClass('fun-chat-message')
                .text(username + ': ' + message)
                .css({ position: 'absolute', cursor: 'pointer' })
                .offset({ left: Math.random() * 500, top: Math.random() * 500 + 50})
                .click(function () {
                    var message = window.prompt("what's the message?");
                    chatHub.server.sendPrivateMessage(username, message);
                    return false;
                });
            funChat.append(newMessage);
        }
        $.connection.hub.start().done(function () {
            chatHub.server.joinRoom(chatroom);
        })*@
    </script>





}


